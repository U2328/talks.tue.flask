<div class="card">
    <div class="card-header"><h5>Speakers</h5></div>
    <div class="card-body">
        {{ speaker_table.generate_html() | safe }}
    </div>
    <div class="card-footer">
        <a href="{{ url_for('admin.speaker') }}" class="btn btn-primary">Add new speaker</a>
    </div>
</div>
{% include 'snippets/speaker/modal.html' %}
{% block script %}
{% include 'snippets/speaker/modal_js.html' %}
<script type="text/javascript">
    {{ speaker_table.generate_js(url_for('api.speaker_table')) | safe }}
    $('#speakerTable').on('click', '.speaker-row', function () {populate_speaker_modal($(this).attr('id'));});
    $('#speakerTable').contextMenu({
        selector: '.speaker-row',
        callback: function(key, options) {
            var id = $(this).attr('id');
            if (key == "open") {populate_speaker_modal(id);}
            if (key == "edit") {window.open("{{ url_for('admin.speaker') }}/" + id, "_self");}
            if (key == "copy") {window.open("{{ url_for('admin.speaker') }}/" + id + "?copy=1", "_self");}
            if (key == "delete") {
                $.ajax({
                    url: '{{ url_for("api.speaker") }}/' + id,
                    type: 'DELETE',
                    success: function(result) {
                        alert("deleted " + id);
                        $("#talkTable").ajax.reload();
                        $("#talkTable").draw();
                    }
                });
            }
        },
        items: {
            "open": {name: "Open", icon: "far fa-eye"},
            "edit": {name: "Edit", icon: "fa-edit"},
            "copy": {name: "Copy", icon: "fa-copy"},
            "delete": {name: "Delete", icon: "far fa-trash-alt"},
        }
    });
</script>
{% endblock script %}